## Модификация

### Модификации [/entity/variant]
Средствами JSON API можно создавать и обновлять сведения о Модификациях товаров, запрашивать списки Модификаций товаров и сведения по отдельным Модификациям. Кодом сущности для Модификации в составе JSON API является ключевое слово **variant**. Больше о Модификациях товаров и работе с ними в основном интерфейсе вы можете прочитать в нашей службе поддержки по
 [этой ссылке](https://support.moysklad.ru/hc/ru/articles/203325413-%D0%9C%D0%BE%D0%B4%D0%B8%D1%84%D0%B8%D0%BA%D0%B0%D1%86%D0%B8%D0%B8-%D1%82%D0%BE%D0%B2%D0%B0%D1%80%D0%BE%D0%B2),
 а также больше о работе с товарами [здесь](https://support.moysklad.ru/hc/ru/sections/200564973-%D0%A2%D0%BE%D0%B2%D0%B0%D1%80%D1%8B-%D0%B8-%D1%81%D0%BA%D0%BB%D0%B0%D0%B4).
По данной сущности можно осуществлять контекстный поиск с помощью специального параметра `search`. Подробнее можно узнать по [ссылке](/api/remap/1.2/doc/index.html#header-контекстный-поиск). Поиск с параметром search отличается от других тем, что поиск не префиксный, без токенизации и идет только по одному полю одновременно. Ищет такие строки, в которые входит значение строки поиска.

Поиск среди объектов модификаций на соответствие поисковой строке будет осуществлён по следующим полям:
+ по наименованию товара с Модификацией **name**

#### Атрибуты Сущности
+ **meta** - [Метаданные](/api/remap/1.2/doc/index.html#header-метаданные) объекта
+ **id** - ID услуги в формате UUID `Только для чтения`
+ **accountId** - ID учетной записи `Только для чтения`
+ **updated** - Момент последнего обновления сущности `Только для чтения`
+ **name** - Наименование товара с Модификацией
+ **code** - Код Модификации
+ **externalCode** - Внешний код Модификации
+ **archived** - Добавлен ли товар в архив
+ **characteristics** - Характеристики Модификации `Необходимое`
+ **minPrice** - Минимальная цена
+ **buyPrice** - Закупочная цена
+ **salePrices** - Цены продажи
+ **barcodes** - Массив штрихкодов модификации
+ **product** - [Метаданные](/api/remap/1.2/doc/index.html#header-метаданные), представляющие с собой ссылку на [товар](/api/remap/1.2/doc/product.html#товар-товары), к которому привязана Модификация. `Необходимое`
+ **things** - Серийные номера `Только для чтения`

#### Атрибуты доступные для сортировки
+ **code** - Код Модификации
+ **externalCode** - Внешний код Модификации
+ **archived** - Добавлен ли товар в архив

#### Атрибуты вложенных сущностей

##### Штрих коды:
При создании штрихкода требуется описать объект с полем, являющимся форматом представления штрихкода в нижнем регистре, со стороковым значением самого штрихкода. Наименование полей отдельного объекта, представляющего штрихкод:
+ **ean13** - штрихкод в формате EAN13, если требуется создать штрихкод в формате EAN13
+ **ean8** - штрихкод в формате EAN8, если требуется создать штрихкод в формате EAN8
+ **code128** - штрихкод в формате Code128, если требуется создать штрихкод в формате Code128

##### Метаданные Модификаций
Метаданные Модификаций содержат информацию о характеристиках Модификаций, а также о типах цен.
Характеристики Модификации - внутренняя коллекция **characteristics**. Представлена в виде массива объектов с полями:
+ **meta** - метаданные характеристики
+ **id** - id соответствующей характеристики.
+ **name** - наименование характеристики.
+ **value** - значение характеристики.

Посмотреть все созданные в основном интерфейсе характеристики Модификаций,
а также все типы цен можно с помощью запроса на получение метаданных Модификаций.
Ответ - объект, со следующей структурой:
+ **meta** - Метаданные
+ **characteristics** - коллекция всех созданных характеристик Модификаций.

Структуры отдельных объектов коллекций:

###### *characteristics*
+ **meta** - Метаданные характеристики
+ **id** - ID характеристики
+ **name** - Наименование характеристики
+ **type** - Тип значения характеристики
+ **required** - Флажок о том, является ли характеристика обязательной

##### Цены продажи
Если у модификации не заданы отдельные цены продажи, в ответе будут выведены соответствующие цены продажи товара.
+ **value** - Значение цены
+ **currency** - Ссылка на валюту в формате [Метаданных](/api/remap/1.2/doc/index.html#header-метаданные)
+ **priceType** - Тип цены

##### Минимальная цена
+ **value** - Значение цены
+ **currency** - Ссылка на валюту в формате [Метаданных](/api/remap/1.2/doc/index.html#header-метаданные)

### Получить список Модификаций [GET]
Запрос на получение списка всех Модификаций на данной учётной записи.
Результат успешного запроса - JSON представление списка Модификаций с перечисленными полями:
- **meta** [Метаданные](/api/remap/1.2/doc/index.html#header-метаданные) о выдаче,
- **context** - [Метаданные](/api/remap/1.2/doc/index.html#header-метаданные) о сотруднике, выполнившем запрос.
- **rows** - Массив JSON объектов, представляющих собой [Модификации](#модификация-модификации).

Возможна фильтрация списка Модификаций по **id** товара - параметр **productid**.
Подробнее про данный параметр можно посмотреть в разделе [Фильтрация выборки с помощью параметра filter](/api/remap/1.2/doc/index.html#header-фильтрация-выборки-с-помощью-параметра-filter)

+ Parameters
  + limit: 1000 (optional, enum[number])
  Максимальное количество сущностей для извлечения.
  <p>
    <code>Допустимые значения 1 - 1000</code>
  </p>
      + Default: `1000`
  + offset: 40 (optional, number)
    Отступ в выдаваемом списке сущностей
      + Default: `0`

+ Response 200 (application/json)
Успешный запрос. Результат - JSON представление списка Модификаций.
  + Body
        <!-- include(body/variant/get_list.json) -->

### Создать Модификацию [POST]
Создать новую Модификацию. Для создания новой Модификации необходимы поля **product**, **characteristics**.
Поле **characteristics** указывается как массив объектов со следующей структурой:
+ **id** - uuid характеристики
+ **value** - значение характеристики
Если поле **id** не указано у какого-либо объекта характеристики, производится поиск соответствующей этому объекту
характеристики по полю **name**. Если же не указаны ни **id** ни **name** произойдёт ошибка.
+ Request Пример (application/json)
Пример запроса на создание новой Модификации, привязанной к существующему товару.
  + Body
        <!-- include(body/variant/post_request.json) -->

+ Response 200 (application/json)
Успешный запрос. Результат - JSON представление созданной Модификации.
  + Body
        <!-- include(body/variant/post_response.json) -->

### Массовое создание и обновление Модификаций [POST]
[Массовое создание и обновление](/api/remap/1.2/doc/index.html#header-создание-и-обновление-нескольких-объектов) Модификаций.
В теле запроса нужно передать массив, содержащий JSON представления Модификаций, которые вы хотите создать или обновить.
Обновляемые Модификации должны содержать идентификатор в виде метаданных.

+ Request Пример (application/json)
Пример создания и обновления нескольких Модификаций
  + Body
        <!-- include(body/variant/post_massive_request.json) -->

+ Response 200 (application/json)
Успешный запрос. Результат - массив JSON представлений созданных и обновленных Модификаций.
  + Body
        <!-- include(body/variant/post_massive_response.json) -->

### Удалить Модификацию [DELETE /entity/variant/{id}]
+ Parameters
  + id: `7944ef04-f831-11e5-7a69-971500188b19` (required, string) - id Модификации

Запрос на удаление Модификации с указанным id.

+ Response 200 (application/json)
Успешное удаление Модификации.

### Метаданные Модификаций [/entity/variant/metadata]
#### Метаданные Модификаций [GET]
Запрос на получение метаданных Модификаций. Результат - объект JSON, включающий в себя:
+ **meta** - Метаданные
+ **characteristics** - коллекция всех созданных характеристик Модификаций.

+ Response 200 (application/json)
Успешный запрос. Результат - JSON представление метаданных модификации.
  + Body
        <!-- include(body/variant/get_metadata.json) -->

### Модификация [/entity/variant/{id}]
Работа с Модификацией с указанным id.
  + Parameters
    + id: `7944ef04-f831-11e5-7a69-971500188b19` (required, string) - id серии
### Получить Модификацию [GET]
Запрос на получение представления Модификации с указанным id.
  + Response 200 (application/json)
  Успешный запрос. Результат - JSON представление Модификации.
    + Body
          <!-- include(body/variant/get_by_id.json) -->

### Изменить Модификацию [PUT]
Запрос на обновление Модификации с указанным id.
Типы цен в ценах продаж обновляются как элементы вложенных коллекций:
+ Если в текущем объекте у какого-то из типов цен нет значения,
а в переданной коллекции оно есть - значение записывается в тип цены.
+ Если же у данного атрибута значение уже присутствует - оно перезаписывается на переданное.
+ Если у данного атрибута в составе объекта значение присутствует, однако оно отсутствует
в передаваемой в теле запроса коллекции (не передаётся совсем), то значение атрибута объекта не изменяется.

При обновлении характеристик Модификации поле **characteristics** указывается как
массив объектов со следующей структурой:
+ **id** - uuid характеристики
+ **name** - наименование характеристики
+ **value** - значение характеристики
Если поле **id** не указано у какого-либо объекта характеристики, производится поиск соответствующей этому объекту
характеристики по полю **name**. Если же не указаны ни **id** ни **name** произойдёт ошибка.
При обновлении, поле **characteristics** в теле запроса обрабатывается как "все характеристики модификации",
т.е. полностью заменяет предыдущий массив характеристик. Если какая то из характеристик, имевшая значение в обновляемом
объекте не указана в запросе на обновление, после запроса её значение будет аннулированно.

+ Request Пример (application/json)
Пример запроса на обновление Модификации.
  + Body
        <!-- include(body/variant/put_request.json) -->

+ Response 200 (application/json)
Успешный запрос. Результат - JSON представление Модификации.
  + Body
        <!-- include(body/variant/put_response.json) -->
