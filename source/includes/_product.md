## Товар
### Товары [/entity/product]
Средствами JSON API можно создавать и обновлять сведения о Товарах, запрашивать списки Товаров и сведения по отдельным Товарам. Упаковками Товаров можно управлять отдельно - с помощью специальных ресурсов. Кодом сущности для Товара в составе JSON API является ключевое слово **product**. Больше о Товарах и работе с ними в основном интерфейсе вы можете прочитать в нашей службе поддержки в разделе
 [Товары и склад](https://support.moysklad.ru/hc/ru/sections/200564973-%D0%A2%D0%BE%D0%B2%D0%B0%D1%80%D1%8B-%D0%B8-%D1%81%D0%BA%D0%BB%D0%B0%D0%B4).
По данной сущности можно осуществлять контекстный поиск с помощью специального параметра `search`. Подробнее можно узнать по [ссылке](/api/remap/1.2/doc/index.html#header-контекстный-поиск).

Поиск среди объектов товаров на соответствие поисковой строке будет осуществлён по следующим полям:
+ по наименованию товара (name)
+ по коду товара (code)
+ по артикулу (article)

#### Атрибуты сущности
+ **meta** - [Метаданные](/api/remap/1.2/doc/index.html#header-метаданные) объекта
+ **id** - ID Товара в формате UUID `Только для чтения`
+ **accountId** - ID учетной записи `Только для чтения`
+ **owner** - Ссылка на Владельца (Сотрудника) в формате [Метаданных](/api/remap/1.2/doc/index.html#header-метаданные)
+ **shared** - Общий доступ
+ **group** - Отдел сотрудника в формате [Метаданных](/api/remap/1.2/doc/index.html#header-метаданные)
+ **syncId** - ID синхронизации. После заполнения недоступен для изменения.
+ **updated** - Момент последнего обновления сущности `Только для чтения`
+ **name** - Наименование Товара `Необходимое`
+ **description** - Описание Товара
+ **code** - Код Товара
+ **externalCode** - Внешний код Товара
+ **archived** - Отметка о том, добавлен ли Товар в архив
+ **pathName** - Наименование группы, в которую входит Товар `Только для чтения`
+ **vat** - НДС %
+ **effectiveVat** - Реальный НДС % `Только для чтения`
+ **productFolder** - Ссылка на группу Товаров в формате [Метаданных](/api/remap/1.2/doc/index.html#header-метаданные)
+ **uom** - Ссылка на единицы измерения в формате [Метаданных](/api/remap/1.2/doc/index.html#header-метаданные)
+ **image** - Изображение Товара
+ **minPrice** - Минимальная цена
+ **buyPrice** - Закупочная цена
+ **salePrices** - Цены продажи
+ **supplier** - Ссылка на контрагента-поставщика в формате [Метаданных](/api/remap/1.2/doc/index.html#header-метаданные)
+ **attributes** - Коллекция доп. полей в формате [Метаданных](/api/remap/1.2/doc/index.html#header-метаданные)
+ **country** - Ссылка на страну в формате [Метаданных](/api/remap/1.2/doc/index.html#header-метаданные)
+ **article** - Артикул
+ **weighed** - Весовой товар
+ **tobacco** - Табачная продукция. Не может быть указан вместе с **alcoholic**, **weighed** и **isSerialTrackable**
+ **weight** - Вес
+ **volume** - Объём
+ **packs** - Упаковки Товара
+ **barcodes** - Массив штрихкодов товара
+ **alcoholic** - Объект, содержащий поля алкогольной продукции.
  + **excise** - Содержит акцизную марку
  + **type**  - Код вида продукции
  + **strength** - Крепость
  + **volume** - Объём тары
+ **variantsCount** - Количество модификаций у данного товара `Только для чтения`
+ **minimumBalance** - Неснижаемый остаток
+ **isSerialTrackable** - Учет по серийным номерам. Не может быть указан вместе с **alcoholic** и **weighed**
+ **things** - Серийные номера `Только для чтения`

Атрибут **pathName** сам по себе является атрибутом только для чтения, однако его можно изменить
с помощью обновления атрибута **productFolder**.

#### Атрибуты вложенных сущностей
##### Упаковки Товара:
+ **id** - ID в формате UUID `Только для чтения`
+ **uom** - Ссылка на единицы измерения в формате [Метаданных](/api/remap/1.2/doc/index.html#header-метаданные) `Необходимое`
+ **quantity** - Количество Товаров в упаковке данного вида `Необходимое`
В версии API 1.2 был удалён отдельный ресурс для работы с упаковками товаров. Теперь упаковки - вложенная коллекция.
Для того, чтобы создать новую упаковку для данного товара, нужно в запросе на обновление товара указать её как элемент
поля **packs**, а в её составе указать ссылку в формате meta на единицу измерения и количество товаров в упаковке.
Нельзя указать ссылку на единицу измерения "Штуки", иначе возникнет ошибка.
При обновлении, переданная коллекция упаковок полностью заменяет имеющуюся до этого коллекцию упаковок.

##### Метаданные Товаров
Метаданные Товаров содержат информацию о дополнительных полях.

Посмотреть все созданные в основном интерфейсе доп. поля Товаров,
а также все типы цен можно с помощью запроса на получение метаданных Товаров.
Ответ - объект, со следующей структурой:
+ **meta** - Метаданные
+ **attributes** - коллекция всех существующих доп. полей Товаров в формате [Метаданных](/api/remap/1.2/doc/index.html#header-метаданные)
+ **createShared** - создавать новые Товары с меткой "Общий"

Структуры объектов отдельных коллекций:

##### Штрих коды:
При создании штрихкода требуется описать объект с полем, являющимся форматом представления штрихкода в нижнем регистре, со стороковым значением самого штрихкода. Наименование полей отдельного объекта, представляющего штрихкод:
+ **ean13** - штрихкод в формате EAN13, если требуется создать штрихкод в формате EAN13
+ **ean8** - штрихкод в формате EAN8, если требуется создать штрихкод в формате EAN8
+ **code128** - штрихкод в формате Code128, если требуется создать штрихкод в формате Code128

О работе с доп. полями Товаров можно прочитать [здесь](/api/remap/1.2/doc/index.html#header-работа-с-дополнительными-полями)

##### Поставщик Товара:
+ **meta** - Метаданные, содержащие ссылку на поставщика.
Тип поставщика - Контрагент. Описание сущности Контрагент вы можете посмотреть [здесь](/api/remap/1.2/doc/counterparty.html#контрагент)

##### Цены продажи
+ **value** - Значение цены
+ **currency** - Ссылка на валюту в формате [Метаданных](/api/remap/1.2/doc/index.html#header-метаданные)
+ **priceType** - Тип цены


##### Закупочная цена
+ **value** - Значение цены
+ **currency** - Ссылка на валюту в формате [Метаданных](/api/remap/1.2/doc/index.html#header-метаданные)

##### Минимальная цена
+ **value** - Значение цены
+ **currency** - Ссылка на валюту в формате [Метаданных](/api/remap/1.2/doc/index.html#header-метаданные)

##### Изображение: структура и загрузка.
Структура поля **image**, которое вы получите при запросе товара с изображением:
+ **meta** - Метаданные об изображении
+ **title** - Название изображения
+ **filename** - Имя файла
+ **size** - Размер файла в байтах
+ **updated** - Дата последнего изменения
+ **miniature** - Ссылка на миниатюру изображения в формате Метаданных
+ **tiny** - Ссылка на уменьшенное изображение в формате Метаданных

<h4>Загрузка</h4>
Для загрузки изображения нужно в теле запроса на [создание](#товар-товары-post) или [обновление](#товар-товар-put) товара
указать поле **image** со следующими атрибутами:
+ **filename** - имя файла с расширением. Например - "банан.png"
+ **content** - Изображение, закодированное в формате Base64.

Если в запросе на обновление не будет полей **filename** и **content**, то весь объект **image**, если он присутствует в Body,
будет проигнорирован, т.к. сервер посчитает, что его обновление не требуется.

##### Группа Товара
+ **meta** - Метаданные, содержащие ссылку на группу Товара.
Описание сущности Группа вы можете посмотреть [здесь](/api/remap/1.2/doc/productFolder.html#группа-товаров-группы-товаров)
Обновление этого атрибута также обновит атрибут **pathName**.

##### Весовой товар
+ **weighed** - Поле, показывающее является ли товар весовым. Если его значение false - поле не отображается.
Если в основном интерфейсе у товара стоит отметка об учёте его по серийным номерам, выставить значение данного поля на true невозможно.

##### Особенности фильтрации поля archived
Если одновременно осуществляется фильтрация по полям **id** и **archived**, то фильтрация по полю **archived** не учитывается.


### Получить список Товаров [GET]
Запрос на получение всех Товаров для данной учётной записи.
Результат: Объект JSON, включающий в себя поля:
- **meta** [Метаданные](/api/remap/1.2/doc/index.html#header-метаданные) о выдаче,
- **context** - [Метаданные](/api/remap/1.2/doc/index.html#header-метаданные) о сотруднике, выполнившем запрос.
- **rows** - Массив JSON объектов, представляющих собой [Товары](#товар-товары).

+ Parameters
  + limit: 1000 (optional, enum[number])
  Максимальное количество сущностей для извлечения.
  <p>
    <code>Допустимые значения 1 - 1000</code>
  </p>
      + Default: `1000`
  + offset: 40 (optional, number)
    Отступ в выдаваемом списке сущностей
      + Default: `0`

+ Response 200 (application/json)
Успешный запрос. Результат - JSON представление списка Товаров.
  + Body
        <!-- include(body/product/get_list_response.json) -->

### Создать Товар [POST]
Создать новый Товар.
#### Описание
Товар создаётся на основе переданного объекта JSON,
который содержит представление нового Товара.
Результат - JSON представление созданного Товара. Для создания нового Товара,
необходимо и достаточно указать в переданном объекте не пустое поле `name`.
Если вы хотите создать алкогольный товар, то в теле запроса, нужно передать
объект **alcoholic**, у которого как минимум одна из характеристик:
+ **excise** - Содержит акцизную марку
+ **type**  - Код вида продукции
+ **strength** - Крепость
+ **volume** - Объём тары

Будет передана с значением. Иначе, при передаче пустого объекта **alcoholic**,
он будет проигнорирован, и товар создастся без пометки "Алкогольная продукция".


При создании товара с указанным массивом штрихкодов для каждого штрихкода требуется указать
к какому типу относится штрихкод. Например, чтобы создать штрихкод с типом  Code 128, в массив штрихкодов
должно быть добавлено поле code128 со значением штрихкода.
+ Request Пример 1 (application/json)
Пример наиболее полного по количеству полей запроса.
  + Body
        <!-- include(body/product/post_request_long.json) -->

+ Response 200 (application/json)
Успешный запрос. Результат - JSON представление созданного Товара.
  + Body
        <!-- include(body/product/post_long_response.json) -->

+ Request Пример 2 (application/json)
Пример запроса на создание Товара с единственным необходимым полем.
  + Body
        <!-- include(body/product/post_request_short.json) -->

+ Response 200 (application/json)
Успешный запрос. Результат - JSON представление созданного Товара.
  + Body
        <!-- include(body/product/post_short_response.json) -->

+ Request Пример с доп. полями (application/json)
Пример запроса на создание Товара с доп. полями.
  + Body
        <!-- include(body/product/post_with_attributes_request.json) -->
+ Response 200 (application/json)
Успешный запрос. Результат - JSON представление созданного Товара.
  + Body
        <!-- include(body/product/post_with_attributes_response.json) -->

+ Request Пример товар с изображением (application/json)
Пример запроса на создание Товара с загрузкой изображения.
  + Body
        <!-- include(body/product/post_with_image_request.json) -->
+ Response 200 (application/json)
Успешный запрос. Результат - JSON представление созданного Товара с изображением.
  + Body
        <!-- include(body/product/post_with_image_response.json) -->

### Массовое создание и обновление товаров [POST]
[Массовое создание и обновление](/api/remap/1.2/doc/index.html#header-создание-и-обновление-нескольких-объектов) товаров.
В теле запроса нужно передать массив, содержащий JSON представления товаров, которые вы хотите создать или обновить.
Обновляемые товары должны содержать идентификатор в виде метаданных.

+ Request Пример (application/json)
Пример создания и обновления нескольких товаров
  + Body
        <!-- include(body/product/post_massive_request.json) -->

+ Response 200 (application/json)
Успешный запрос. Результат - массив JSON представлений созданных и обновленных товаров.
  + Body
        <!-- include(body/product/post_massive_response.json) -->


### Удалить Товар [DELETE /entity/product/{id}]
+ Parameters
  + id: `7944ef04-f831-11e5-7a69-971500188b19` (required, string) - id Товара

Запрос на удаление Товара с указанным id.

+ Response 200 (application/json)
Успешное удаление Товара.

### Метаданные Товаров [/entity/product/metadata]
#### Метаданные Товаров [GET]
Запрос на получение метаданных Товаров. Результат - объект JSON, включающий в себя:
+ **meta** - Метаданные
+ **attributes** - коллекция всех существующих доп. полей Товаров в формате [Метаданных](/api/remap/1.2/doc/index.html#header-метаданные)
+ **createShared** - создавать новые комплекты с меткой "Общий"

Структура отдельного объекта, представляющего доп. поле подробно описана в разделе [Работа с дополнительными полями](/api/remap/1.2/doc/index.html#header-работа-с-дополнительными-полями).
+ Response 200 (application/json)
Успешный запрос. Результат - JSON представление доп. полей Товаров.
  + Body
        <!-- include(body/product/get_metadata.json) -->

### Отдельное доп. поле [/entity/product/metadata/attributes/{id}]
+ Parameters
  + id: `7944ef04-f831-11e5-7a69-971500188b19` (required, string) - id Доп. поля
#### Отдельное доп. поле [GET]
Запрос на получение информации по отдельному дополнительному полю.
+ Response 200 (application/json)
Успешный запрос. Результат - JSON представление отдельного доп. поля.
  + Body
        <!-- include(body/product/metadata_by_id.json) -->

### Товар [/entity/product/{id}]
Товар, обращение к которому происходит по значению его id.

+ Parameters
  + id: `7944ef04-f831-11e5-7a69-971500188b19` (required, string) - id Товара.

### Получить Товар [GET]
Запрос на получение Товара с указанным id.

+ Response 200 (application/json)
Успешный запрос. Результат - JSON представление Товара.
  + Body
        <!-- include(body/product/get_by_id_response.json) -->

### Изменить Товар [PUT]
Запрос на обновление существующего Товара.
Типы цен в ценах продаж и дополнительные поля обновляются как элементы вложенных коллекций:
+ Если в текущем объекте у какого-то из доп. полей / типов цен нет значения,
а в переданной коллекции оно есть - значение записывается в доп. поле / тип цены.
+ Если же у данного атрибута значение уже присутствует - оно перезаписывается на переданное.
+ Если у данного атрибута в составе объекта значение присутствует, однако оно отсутствует
в передаваемой в теле запроса коллекции (не передаётся совсем), то значение атрибута объекта не изменяется.

Для обновленя полей алкогольной продукции в теле запроса на обновление товара должен присутствовать объект **alcoholic**,
с вложенными в него полями, отражающими свойства алкогольной продукции:
+ **excise** - Содержит акцизную марку
+ **type**  - Код вида продукции
+ **strength** - Крепость
+ **volume** - Объём тары
Если в запросе на обновление товара, являющегося алкогольной продукцией, передать пустой объект **alcoholic**, с данного объекта
снимется отметка "Алкогольная продукция". Для того чтобы сделать товар, не являющийся алкогольной продукцией алкогольным, нужно в теле запроса
передать объект **alcoholic**, у которого хотя бы одно из свойств будет иметь значение.

При обновлении товара с указанным в теле запроса массивом штрихкодов, каждый штрихкод проходит проверку
на то, к какому типу он относится EAN 8, EAN 13. Если же штрихкод не относится ни к одному из этих
2 типов, он записывается как штрихкод типа Code 128. Переданный массив штрихкодов полностью заменяет предыдущий массив штрихкодов.

При включенном в основном интерфейсе серийном учёте товаров, в запросе на обновление нельзя передать значение true полю **weighed**,
иначе возникнет ошибка, т.к. невозможен серийный учёт весовых товаров.

+ Request Пример (application/json)
Пример запроса на обновление Товара
  + Body
        <!-- include(body/product/put_request.json) -->

+ Response 200 (application/json)
Успешный запрос. Результат - JSON представление обновлённого Товара.
  + Body
        <!-- include(body/product/put_response.json) -->

+ Request Пример с доп. полями (application/json)
Пример запроса на изменение Товара с дополнительными полями.
  + Body
        <!-- include(body/product/put_with_attributes_request.json) -->
+ Response 200 (application/json)
Успешный запрос. Результат - JSON представление обновлённого Товара.
  + Body
        <!-- include(body/product/put_with_attributes_response.json) -->
