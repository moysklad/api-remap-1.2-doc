# This workflow warns and then closes issues and PRs that have had no activity for a specified amount of time.
#
# You can adjust the behavior by modifying this file.
# For more information, see:
# https://github.com/actions/stale
name: Notify Mattermost on New Issues

on:
  issues:
    types: [opened]

jobs:
  notify-mattermost:
    runs-on: ubuntu-latest
    steps:
      - name: Send notification to Mattermost
        env:
          WEBHOOK_URL: ${{ secrets.MATTERMOST_WEBHOOK_URL }}
        run: |
          curl -X POST -H 'Content-Type: application/json' \
          -d '{
                "text": "**New Issue Created**",
                "attachments": [
                  {
                    "title": "Issue: #${{ github.event.issue.number }} - ${{ github.event.issue.title }}",
                    "title_link": "${{ github.event.issue.html_url }}",
                    "text": "${{ github.event.issue.body }}",
                    "color": "#ff0000"
                  }
                ]
              }' \
          "$WEBHOOK_URL"
